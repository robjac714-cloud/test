<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reelly API - Simple Fetch</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Tahoma; padding:16px; background:#f7f7fb;}
    .box{background:#fff; border:1px solid #ddd; border-radius:12px; padding:12px; margin:10px 0;}
    input{width:100%; padding:10px; border:1px solid #ccc; border-radius:10px;}
    button{padding:10px 14px; border:0; border-radius:10px; background:#2563eb; color:#fff; font-weight:700; cursor:pointer;}
    pre{white-space:pre-wrap; word-break:break-word; background:#0b1220; color:#e5e7eb; padding:12px; border-radius:12px;}
  </style>
</head>
<body>

  <h2>Reelly API (Simple)</h2>

  <div class="box">
    <label>Query String (Parameters)</label>
    <input id="qs" value="country=UAE&region=Dubai&search_query=Dubai&per_page=5&page=1" />
    <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
      <button id="go">Fetch</button>
      <button id="dubai">Dubai</button>
      <button id="marina">Marina</button>
      <button id="reset">Reset</button>
    </div>
  </div>

  <div class="box">
    <div><b>Status:</b> <span id="status">—</span></div>
    <div><b>URL:</b> <span id="url">—</span></div>
  </div>

  <div class="box">
    <h3>Results (raw JSON)</h3>
    <pre id="out">اضغط Fetch…</pre>
  </div>

<script>
  const API_BASE = "https://search-listings-production.up.railway.app/v1/properties";
  const API_KEY  = "reelly-80fd5f24-WLrF9bAxkGwYrUXFjrIyzNxRlzrB4kpH";

  const qsEl = document.getElementById("qs");
  const outEl = document.getElementById("out");
  const statusEl = document.getElementById("status");
  const urlEl = document.getElementById("url");

  async function fetchReelly(){
    const qs = qsEl.value.trim();
    const url = `${API_BASE}?${qs}`;

    statusEl.textContent = "…";
    urlEl.textContent = url;
    outEl.textContent = "Loading...";

    try{
      const r = await fetch(url, {
        method: "GET",
        headers: {
          "X-API-Key": API_KEY,
          "accept": "application/json"
        }
      });

      const text = await r.text();
      statusEl.textContent = r.status;

      // حاول نعرض JSON مرتب، وإذا مو JSON اعرضه نص
      try{
        const data = JSON.parse(text);
        outEl.textContent = JSON.stringify(data, null, 2);
      }catch{
        outEl.textContent = text;
      }

    }catch(err){
      statusEl.textContent = "Network error";
      outEl.textContent = String(err);
    }
  }

  document.getElementById("go").addEventListener("click", fetchReelly);

  document.getElementById("dubai").addEventListener("click", ()=>{
    qsEl.value = "country=UAE&region=Dubai&search_query=Dubai&per_page=5&page=1";
  });

  document.getElementById("marina").addEventListener("click", ()=>{
    qsEl.value = "country=UAE&region=Dubai&search_query=Marina&per_page=5&page=1";
  });

  document.getElementById("reset").addEventListener("click", ()=>{
    qsEl.value = "country=UAE&region=Dubai&search_query=Dubai&per_page=5&page=1";
    outEl.textContent = "اضغط Fetch…";
    statusEl.textContent = "—";
    urlEl.textContent = "—";
  });
</script>

</body>
</html>
